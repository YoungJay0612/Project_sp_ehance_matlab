<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">y</span> = expint(<span class="var type1" id="S3T1U6">x</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%EXPINT Exponential integral function.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%   Y = EXPINT(X) is the exponential integral function for each</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%   element of X.  The exponential integral is defined as:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">%   EXPINT(x) = integral from x to Inf of (exp(-t)/t) dt, for x &gt; 0.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">%   </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%   By analytic continuation, EXPINT is a scalar-valued function in</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">%   the complex plane cut along the negative real axis.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%   Another common definition of the exponential integral function is</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%   the Cauchy principal value integral from -Inf to X of (exp(t)/t)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%   dt, for positive X.  This is denoted as Ei(x). The relationships</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%   between EXPINT(x) and Ei(x) are as follows:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%       EXPINT(-x+i*0) = -Ei(x) - i*pi, for real x &gt; 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%       Ei(x) = REAL(-EXPINT(-x)), for real x &gt; 0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">%   Class support for input X:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%      float: double, single</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%   Copyright 1984-2011 The MathWorks, Inc. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%       For elements of X in [-38,2], EXPINT uses a series expansion</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%       representation (equation 5.1.11 from Abramowitz &amp; Stegun).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%       For all other elements of X, EXPINT uses a continued fraction</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%       representation (equation 5.1.22 in A&amp;S).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%       References:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">%         [1] M. Abramowitz and I.A. Stegun, "Handbook of Mathematical</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%         Functions", Dover Publications, 1965, Ch. 5.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo " id="T2:U3"><span class="var type1" id="S4T2U9">siz</span> = <span class="mxinfo " id="T2:U5">size(<span class="var type1" id="S3T1U12">x</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo " id="T1:U7"><span class="var type1" id="S2T1U15">y</span> = <span class="mxinfo " id="T1:U9">zeros(numel(<span class="var type1" id="S3T1U20">x</span>),1,superiorfloat(<span class="var type1" id="S3T1U24">x</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">% make input a column vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo " id="T1:U12"><span class="var type1" id="S3T1U27">x</span> = <span class="var type1" id="S3T1U29">x</span>(:)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">% figure out which algorithm to use by evaluating interpolating polynomial </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">% at real(z)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo " id="T3:U15"><span class="var type1" id="S9T3U33">p</span> = <span class="mxinfo " id="T3:U17">[-3.602693626336023e-09 -4.819538452140960e-07 -2.569498322115933e-05 <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">     -6.973790859534190e-04 -1.019573529845792e-02 -7.811863559248197e-02 <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line">     -3.012432892762715e-01 -7.773807325735529e-01  8.267661952366478e+00]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T1:U18"><span class="var type1" id="S10T1U55">polyv</span> = <span class="mxinfo " id="T1:U20">polyval(<span class="var type1" id="S9T3U58">p</span>,real(<span class="var type1" id="S3T1U61">x</span>))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">% series expansion</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="mxinfo " id="T4:U23"><span class="var type1" id="S13T4U64">k</span> = <span class="mxinfo " id="T4:U25">find( <span class="mxinfo " id="T5:U26"><span class="mxinfo " id="T1:U27">abs(<span class="mxinfo " id="T1:U28">imag(<span class="var type1" id="S3T1U72">x</span>)</span>)</span> &lt;= <span class="var type1" id="S10T1U73">polyv</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T5:U31">~<span class="mxinfo " id="T5:U32">isempty(<span class="var type1" id="S13T4U79">k</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">   <span class="comment">%initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">   <span class="mxinfo " id="T1:U34"><span class="var type1" id="S18T1U82">egamma</span>=<span class="mxinfo " id="T1:U36">0.57721566490153286061</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">   <span class="mxinfo " id="T4:U37"><span class="var type1" id="S19T4U86">xk</span> = <span class="mxinfo " id="T4:U39"><span class="var type1" id="S3T1U88">x</span>(<span class="var type1" id="S13T4U89">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">   <span class="mxinfo " id="T4:U42"><span class="var type1" id="S20T4U92">yk</span> = <span class="mxinfo " id="T4:U44"><span class="mxinfo " id="T1:U45">-<span class="var type1" id="S18T1U95">egamma</span></span> - <span class="mxinfo " id="T4:U47">log(<span class="var type1" id="S19T4U98">xk</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">   <span class="mxinfo " id="T1:U49"><span class="var type1" id="S22T1U101">j</span> = <span class="mxinfo " id="T1:U51">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">   <span class="mxinfo " id="T4:U52"><span class="var type1" id="S23T4U105">pterm</span> = <span class="var type1" id="S19T4U106">xk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">   <span class="mxinfo " id="T4:U55"><span class="var type1" id="S24T4U109">term</span> = <span class="var type1" id="S19T4U110">xk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">   <span class="keyword">while</span> <span class="mxinfo " id="T6:U58"><span class="message error" id="M1F1C">any(<span class="mxinfo " id="T7:U59"><span class="mxinfo " id="T4:U60">abs(<span class="var type1" id="S24T4U117">term</span>)</span> &gt; (<span class="mxinfo " id="T4:U62">eps(<span class="var type1" id="S20T4U121">yk</span>)</span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">      <span class="mxinfo " id="T4:U64"><span class="var type1" id="S20T4U124">yk</span> = <span class="mxinfo " id="T4:U66"><span class="var type1" id="S20T4U126">yk</span> + <span class="var type1" id="S24T4U127">term</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">      <span class="mxinfo " id="T1:U69"><span class="var type1" id="S22T1U130">j</span> = <span class="mxinfo " id="T1:U71"><span class="var type1" id="S22T1U132">j</span> + <span class="mxinfo " id="T1:U73">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">      <span class="mxinfo " id="T4:U74"><span class="var type1" id="S23T4U136">pterm</span> = <span class="mxinfo " id="T4:U76"><span class="mxinfo " id="T4:U77">-<span class="var type1" id="S19T4U140">xk</span>.*<span class="var type1" id="S23T4U141">pterm</span></span>/<span class="var type1" id="S22T1U142">j</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">      <span class="mxinfo " id="T4:U81"><span class="var type1" id="S24T4U145">term</span> = <span class="mxinfo " id="T4:U83"><span class="var type1" id="S23T4U147">pterm</span>/<span class="var type1" id="S22T1U148">j</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">   <span class="keyword">end</span> <span class="comment">% end of the while loop</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">   <span class="mxinfo " id="T4:U86"><span class="mxinfo " id="T4:U87"><span class="var type1" id="S2T1U152">y</span>(<span class="var type1" id="S13T4U153">k</span>)</span> = <span class="var type1" id="S20T4U154">yk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="comment">% continued fraction</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T4:U91"><span class="var type1" id="S13T4U157">k</span> = <span class="mxinfo " id="T4:U93">find( <span class="mxinfo " id="T5:U94"><span class="mxinfo " id="T1:U95">abs(<span class="mxinfo " id="T1:U96">imag(<span class="var type1" id="S3T1U165">x</span>)</span>)</span> &gt; <span class="var type1" id="S10T1U166">polyv</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T5:U99">~<span class="mxinfo " id="T5:U100">isempty(<span class="var type1" id="S13T4U172">k</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">   <span class="comment">%   note: am1, bm1 corresponds to A(j-1), B(j-1) of recursion formulae</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">   <span class="comment">%         am2, bm2 corresponds to A(j-2), B(j-2) of recursion formulae</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">   <span class="comment">%         a,b      corresponds to A(j), B(j) of recursion formulae</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">   <span class="mxinfo " id="T1:U102"><span class="var type1" id="S27T1U175">n</span> = <span class="mxinfo " id="T1:U104">1</span></span>; <span class="comment">% we're calculating E1(x)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">   <span class="comment">% initialization</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">   <span class="mxinfo " id="T4:U105"><span class="var type1" id="S19T4U179">xk</span> = <span class="mxinfo " id="T4:U107"><span class="var type1" id="S3T1U181">x</span>(<span class="var type1" id="S13T4U182">k</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">   <span class="mxinfo " id="T4:U110"><span class="var type1" id="S28T4U185">am2</span> = <span class="mxinfo " id="T4:U112">zeros(<span class="mxinfo " id="T1:U113">size(<span class="var type1" id="S19T4U190">xk</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">   <span class="mxinfo " id="T4:U115"><span class="var type1" id="S29T4U193">bm2</span> = <span class="mxinfo " id="T4:U117">ones(<span class="mxinfo " id="T1:U118">size(<span class="var type1" id="S19T4U198">xk</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">   <span class="mxinfo " id="T4:U120"><span class="var type1" id="S31T4U201">am1</span> = <span class="mxinfo " id="T4:U122">ones(<span class="mxinfo " id="T1:U123">size(<span class="var type1" id="S19T4U206">xk</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">   <span class="mxinfo " id="T4:U125"><span class="var type1" id="S32T4U209">bm1</span> = <span class="var type1" id="S19T4U210">xk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">   <span class="mxinfo " id="T4:U128"><span class="var type1" id="S33T4U213">f</span> = <span class="mxinfo " id="T4:U130"><span class="var type1" id="S31T4U215">am1</span> ./ <span class="var type1" id="S32T4U216">bm1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">   <span class="mxinfo " id="T4:U133"><span class="var type1" id="S34T4U219">oldf</span> = <span class="mxinfo " id="T4:U135">Inf(<span class="mxinfo " id="T1:U136">size(<span class="var type1" id="S19T4U224">xk</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">   <span class="mxinfo " id="T1:U138"><span class="var type1" id="S22T1U227">j</span> = <span class="mxinfo " id="T1:U140">2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">   <span class="keyword">while</span> <span class="mxinfo " id="T6:U141"><span class="message error" id="M2F1C">any(<span class="mxinfo " id="T7:U142"><span class="mxinfo " id="T4:U143">abs(<span class="mxinfo " id="T4:U144"><span class="var type1" id="S33T4U236">f</span>-<span class="var type1" id="S34T4U237">oldf</span></span>)</span> &gt; (<span class="mxinfo " id="T4:U147"><span class="mxinfo " id="T1:U148"><span class="mxinfo " id="T1:U149">100</span>*<span class="mxinfo " id="T1:U150">eps(class(<span class="var type1" id="S33T4U246">f</span>))</span></span>.*<span class="mxinfo " id="T4:U152">abs(<span class="var type1" id="S33T4U249">f</span>)</span></span>)</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">       <span class="comment">% calculate the coefficients of the recursion formulas for j even</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">       <span class="mxinfo " id="T1:U154"><span class="var type1" id="S37T1U252">alpha</span> = <span class="mxinfo " id="T1:U156"><span class="mxinfo " id="T1:U157"><span class="var type1" id="S27T1U255">n</span>-<span class="mxinfo " id="T1:U159">1</span></span>+(<span class="mxinfo " id="T1:U160"><span class="var type1" id="S22T1U259">j</span>/<span class="mxinfo " id="T1:U162">2</span></span>)</span></span>; <span class="comment">% note: beta= 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">       <span class="comment">%calculate A(j), B(j), and f(j)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">       <span class="mxinfo " id="T4:U163"><span class="var type1" id="S38T4U263">a</span> = <span class="mxinfo " id="T4:U165"><span class="var type1" id="S31T4U265">am1</span> + <span class="mxinfo " id="T4:U167"><span class="var type1" id="S37T1U267">alpha</span> * <span class="var type1" id="S28T4U268">am2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">       <span class="mxinfo " id="T4:U170"><span class="var type1" id="S39T4U271">b</span> = <span class="mxinfo " id="T4:U172"><span class="var type1" id="S32T4U273">bm1</span> + <span class="mxinfo " id="T4:U174"><span class="var type1" id="S37T1U275">alpha</span> * <span class="var type1" id="S29T4U276">bm2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">       <span class="comment">% save new normalized variables for next pass through the loop</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">       <span class="comment">%  note: normalization to avoid overflow or underflow</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">       <span class="mxinfo " id="T4:U177"><span class="var type1" id="S28T4U279">am2</span> = <span class="mxinfo " id="T4:U179"><span class="var type1" id="S31T4U281">am1</span> ./ <span class="var type1" id="S39T4U282">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">       <span class="mxinfo " id="T4:U182"><span class="var type1" id="S29T4U285">bm2</span> = <span class="mxinfo " id="T4:U184"><span class="var type1" id="S32T4U287">bm1</span> ./ <span class="var type1" id="S39T4U288">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">       <span class="mxinfo " id="T4:U187"><span class="var type1" id="S31T4U291">am1</span> = <span class="mxinfo " id="T4:U189"><span class="var type1" id="S38T4U293">a</span> ./ <span class="var type1" id="S39T4U294">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">       <span class="mxinfo " id="T1:U192"><span class="var type1" id="S32T1U297">bm1</span> = <span class="mxinfo " id="T1:U194">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">       <span class="mxinfo " id="T4:U195"><span class="var type1" id="S33T4U301">f</span> = <span class="var type1" id="S31T4U302">am1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">       <span class="mxinfo " id="T1:U198"><span class="var type1" id="S22T1U305">j</span> = <span class="mxinfo " id="T1:U200"><span class="var type1" id="S22T1U307">j</span>+<span class="mxinfo " id="T1:U202">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">       <span class="comment">% calculate the coefficients for j odd</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">       <span class="mxinfo " id="T1:U203"><span class="var type1" id="S37T1U311">alpha</span> = <span class="mxinfo " id="T1:U205">(<span class="mxinfo " id="T1:U206"><span class="var type1" id="S22T1U315">j</span>-<span class="mxinfo " id="T1:U208">1</span></span>)/<span class="mxinfo " id="T1:U209">2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">       <span class="mxinfo " id="T4:U210"><span class="var type1" id="S40T4U320">beta</span> = <span class="var type1" id="S19T4U321">xk</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">       <span class="mxinfo " id="T4:U213"><span class="var type1" id="S38T4U324">a</span> = <span class="mxinfo " id="T4:U215"><span class="mxinfo " id="T4:U216"><span class="var type1" id="S40T4U327">beta</span> .* <span class="var type1" id="S31T4U328">am1</span></span> + <span class="mxinfo " id="T4:U219"><span class="var type1" id="S37T1U330">alpha</span> * <span class="var type1" id="S28T4U331">am2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">       <span class="mxinfo " id="T4:U222"><span class="var type1" id="S39T4U334">b</span> = <span class="mxinfo " id="T4:U224"><span class="mxinfo " id="T4:U225"><span class="var type1" id="S40T4U337">beta</span> .* <span class="var type1" id="S32T1U338">bm1</span></span> + <span class="mxinfo " id="T4:U228"><span class="var type1" id="S37T1U340">alpha</span> * <span class="var type1" id="S29T4U341">bm2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">       <span class="mxinfo " id="T4:U231"><span class="var type1" id="S28T4U344">am2</span> = <span class="mxinfo " id="T4:U233"><span class="var type1" id="S31T4U346">am1</span> ./ <span class="var type1" id="S39T4U347">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">       <span class="mxinfo " id="T4:U236"><span class="var type1" id="S29T4U350">bm2</span> = <span class="mxinfo " id="T4:U238"><span class="var type1" id="S32T1U352">bm1</span> ./ <span class="var type1" id="S39T4U353">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">       <span class="mxinfo " id="T4:U241"><span class="var type1" id="S31T4U356">am1</span> = <span class="mxinfo " id="T4:U243"><span class="var type1" id="S38T4U358">a</span> ./ <span class="var type1" id="S39T4U359">b</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">       <span class="mxinfo " id="T4:U246"><span class="var type1" id="S32T4U362">bm1</span> = <span class="mxinfo " id="T1:U248">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">       <span class="mxinfo " id="T4:U249"><span class="var type1" id="S34T4U366">oldf</span> = <span class="var type1" id="S33T4U367">f</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">       <span class="mxinfo " id="T4:U252"><span class="var type1" id="S33T4U370">f</span> = <span class="var type1" id="S31T4U371">am1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">       <span class="mxinfo " id="T1:U255"><span class="var type1" id="S22T1U374">j</span> = <span class="mxinfo " id="T1:U257"><span class="var type1" id="S22T1U376">j</span>+<span class="mxinfo " id="T1:U259">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">   <span class="keyword">end</span>  <span class="comment">% end of the while loop</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">   <span class="message error" id="M3F1C"><span class="mxinfo " id="T4:U260"><span class="var type1" id="S2T1U381">y</span>(<span class="var type1" id="S13T4U382">k</span>)</span>= <span class="mxinfo " id="T8:U263"><span class="mxinfo " id="T4:U264"><span class="mxinfo " id="T4:U265">exp(<span class="mxinfo " id="T4:U266">-<span class="var type1" id="S19T4U388">xk</span></span>)</span> .* <span class="var type1" id="S33T4U389">f</span></span> - <span class="mxinfo " id="T8:U269">1i*pi*(<span class="mxinfo " id="T7:U270">(<span class="mxinfo " id="T7:U271">real(<span class="var type1" id="S19T4U401">xk</span>)&lt;<span class="mxinfo " id="T1:U273">0</span></span>)&amp;(<span class="mxinfo " id="T7:U274"><span class="mxinfo " id="T4:U275">imag(<span class="var type1" id="S19T4U407">xk</span>)</span>==<span class="mxinfo " id="T1:U277">0</span></span>)</span>)</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line"><span class="mxinfo " id="T1:U278"><span class="var type1" id="S2T1U411">y</span> = <span class="mxinfo " id="T1:U280">reshape(<span class="var type1" id="S2T1U414">y</span>,<span class="var type1" id="S4T2U415">siz</span>)</span></span>;</span></span>
</pre>
